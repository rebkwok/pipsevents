{% extends 'account/base.html' %}
{% load bookingtags %}

{% block content %}

       <div class="card card-wm mt-4">
            <div class="card-header">
                <h1 class="card-title">Your Profile</h1>
            </div>
           <div class="card-body">
               <div class="col-12">
                   <span class="col-3"><strong>Username:</strong></span>
                   <span class="col-9">{{ user.username }}</span>
               </div>

               <div class="col-12">
                   <span class="col-3"><strong>First name:</strong></span>
                   <span class="col-9">{{ user.first_name }}</span>
               </div>

               <div class="col-12">
                   <span class="col-3"><strong>Last name:</strong></span>
                   <span class="col-6 col-sm-4 col-md-4 col-lg-3">{{ user.last_name }}</span>
                  <span class="col-3 col-sm-5 col-md-5 col-lg-6"><a class="btn btn-sm btn-profile btn-wm-outline" href="{% url 'profile:update_profile' %}">Change</a></span>
               </div>

               <div class="col-12">
                   <span class="col-3"><strong>Primary email address:</strong></span>
                   <span class="col-6 col-sm-4 col-md-4 col-lg-3">{{ user.email }}</span>
                    <span class="col-3 col-sm-5 col-md-5 col-lg-6"><a class="btn btn-sm btn-profile btn-wm-outline" href="{% url 'account_email' %}">Change</a></span>
               </div>

                <div class="col-12">
                   <span class="col-3"><strong>Connected social accounts:</strong></span>
                   <span class="col-6 col-sm-4 col-md-4 col-lg-3">
                       {% if user.socialaccount_set.exists %}
                            {% for sacc in user.socialaccount_set.all %}{{ sacc.provider|title }}{% if not forloop.last %}; {% endif %}{% endfor %}
                       {% else %}
                           None
                        {% endif %}
                   </span>
                    <span class="col-3 col-sm-5 col-md-5 col-lg-6"><a class="btn btn-sm btn-profile btn-wm-outline" href="{% url 'socialaccount_connections' %}">Change</a></span>
               </div>

               <div class="col-12 mb-1">
                   <span class="col-3"><strong>Account Status:</strong></span>
                   <span class="col-9">
                           {% if user.is_staff %}
                                Staff
                           {% elif user|in_group:"instructors" %}
                                Instructor
                           {% elif perms.booking.is_regular_student %}
                                Registered Student (confirmed regular student)
                           {% else %}
                                Registered Student
                           {% endif %}
                   </span>
               </div>

                   {% if request.user.is_staff or request.user|has_booked_class %}
                   <div class="col-12">
                   <span class="col-3"><strong>Mailing List:</strong></span>
                   <span class="col-6 col-sm-4 col-md-4 col-lg-3">
                           {% if request.user|subscribed %}
                                Subscribed
                           {% else %}
                                Not subscribed
                           {% endif %}
                   </span>
                  <span class="col-3 col-sm-5 col-md-5 col-lg-6"><a class="btn btn-sm btn-profile btn-wm-outline" href="{% url 'subscribe' %}">Change</a></span>
                  </div>
                   {% endif %}

                   <div class="col-12">
                   <span class="col-3"><strong>Disclaimer:</strong></span>
                   <span class="col-9">
                           {% if disclaimer %}
                                Completed
                            {% elif expired_disclaimer %}
                                Expired
                           {% else %}
                                Not completed
                           {% endif %}
                   </span>
                   </div>
                   {% if not disclaimer %}
                   <div class="col-12 mt-4">
                       <h3>DISCLAIMER</h3>
                       {% if expired_disclaimer %}
                            <p>Your disclaimer has expired.  We require disclaimers to be updated once a year for health and safety reasons.
                           You must review and confirm your information before attending any classes or workshops.</p>
                       {% else %}
                            <p>You have not completed a disclaimer form.
                           This must be completed before attending any classes or workshops.</p>
                       {% endif %}
                       <p><a href="{% url 'disclaimer_form' %}">Complete disclaimer form now</a></p>
                   </div>
                   {% else %}
                       <div class="col-12">
                           <p>If you have any additional questions or concerns about the information you have provided, please contact
                            <a href="mailto:{{ studio_email }}">{{ studio_email }}</a>.</p>

                       </div>
                   {% endif %}
                <div class="col-12">
                   <p>View our <a href="{% url 'data_privacy_policy' %}">data privacy and cookie policy.</a></p>
               </div>

        </div>
{% endblock content %}

